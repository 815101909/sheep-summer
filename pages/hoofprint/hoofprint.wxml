<!-- pages/hoofprint/hoofprint.wxml -->
<!-- 背景层 -->
<view class="background-container {{themeClass}}">
  <image class="background-image" src="/assets/images/splash-bg.png" mode="aspectFill" lazy-load="true" />
</view>

<!-- 盛夏蹄印 · 闯关式功能地图（标题已去掉，只保留闯关入口） -->
<view class="hoofprint-journey {{themeClass}}">
  <view class="today-sheep-row">
    <text class="today-sheep-sub">今天想把哪一刻装进盛夏？</text>
  </view>

  <view class="journey-map">
    <!-- 中央小卡片默认形象 -->
    <view class="center-ring outer"></view>
    <view class="center-ring inner"></view>
    <view class="center-avatar-wrap">
      <image class="center-avatar" src="/assets/images/小卡片默认形象.png" mode="widthFix" lazy-load="true" />
    </view>

    <!-- 抽取能量卡片 -->
    <view class="station-node station-1" wx:if="{{stationVisibility.charging}}" bindtap="tapStation" data-station="charging">
      <view class="station-remove" catchtap="onRemoveStationTap" data-station="charging">
        <text class="station-remove-icon">-</text>
      </view>
      <text class="station-name">抽取能量卡片</text>
      <text class="station-desc">抽取专属能量卡片</text>
    </view>

    <!-- 勇气补给 -->
    <view class="station-node station-2" wx:if="{{stationVisibility.supply}}" bindtap="tapStation" data-station="supply">
      <view class="station-remove" catchtap="onRemoveStationTap" data-station="supply">
        <text class="station-remove-icon">-</text>
      </view>
      <text class="station-name">勇气补给</text>
      <text class="station-desc">为下一步装好盔甲</text>
    </view>

    <!-- 独处净土 -->
    <view class="station-node station-3" wx:if="{{stationVisibility.solitude}}" bindtap="tapStation" data-station="solitude">
      <view class="station-remove" catchtap="onRemoveStationTap" data-station="solitude">
        <text class="station-remove-icon">-</text>
      </view>
      <text class="station-name">独处净土</text>
      <text class="station-desc">把安静留给自己</text>
    </view>

    <!-- 时光胶囊 -->
    <view class="station-node station-4" wx:if="{{stationVisibility.time}}" bindtap="tapStation" data-station="time">
      <view class="station-remove" catchtap="onRemoveStationTap" data-station="time">
        <text class="station-remove-icon">-</text>
      </view>
      <text class="station-name">时光胶囊</text>
      <text class="station-desc">把此刻装进胶囊</text>
    </view>

    <!-- 弹走烦恼 -->
    <view class="station-node station-5" wx:if="{{stationVisibility.worry}}" bindtap="tapStation" data-station="worry">
      <view class="station-remove" catchtap="onRemoveStationTap" data-station="worry">
        <text class="station-remove-icon">-</text>
      </view>
      <text class="station-name">弹走烦恼</text>
      <text class="station-desc">把不开心都弹出去</text>
    </view>
  </view>

  <!-- 利用下方空白，做一行文艺提示 -->
  <view class="journey-footer">
    <view class="sheep-raid-btn" bindtap="goSheepRaid">
      <text class="sheep-raid-title">一起守护绵羊副本</text>
    </view>
    <text class="journey-footer-main">今天的心情，慢慢落在盛夏里。</text>
    <text class="journey-footer-sub">清晨散步组 · 午后走走组 · 夜跑小分队 · 3000 步帮绵羊向前走</text>
  </view>

  <!-- 被删掉的小站，收纳在底部 -->
  <view class="deleted-stations" wx:if="{{deletedStations.length > 0}}">
    <text class="deleted-title">以下小站先暂时收纳在页脚：</text>
    <view class="deleted-list">
      <block wx:for="{{deletedStations}}" wx:key="id">
        <view class="deleted-tag" bindtap="onRestoreStationTap" data-id="{{item.id}}">
          <text class="deleted-name">{{item.name}}</text>
          <text class="deleted-hint">点我放回地图</text>
        </view>
      </block>
    </view>
  </view>
</view>

<!-- 能量卡片弹窗 -->
<view class="energy-card-modal" wx:if="{{showEnergyCardModal}}">
  <view class="energy-card-overlay" catchtap="closeEnergyCardModal"></view>
  <view class="energy-card-container">
    <view class="energy-card-header">
      <text class="energy-card-title">能量卡片</text>
      <text class="energy-card-close" catchtap="closeEnergyCardModal">×</text>
    </view>
    <view class="energy-card-body">
      <view wx:if="{{energyCardLoading}}" class="loading-view">
        <text class="loading-text">抽取中...</text>
      </view>
      <view wx:elif="{{energyCardImage}}" class="image-container">
        <image wx:key="{{forceEnergyCardRender}}" class="energy-card-image" src="{{energyCardImage}}" mode="widthFix" 
               bindload="onEnergyCardImageLoad" binderror="onEnergyCardImageError" 
               bindtap="reloadEnergyCardImage" lazy-load="{{false}}" show-menu-by-longpress="{{false}}"></image>
      </view>
      <view wx:else>
        <text>暂无图片</text>
      </view>
    </view>
  </view>
</view>

<!-- （日期筛选 + 历史时间线已按需求整体移除，盛夏蹄印只保留上方闯关地图） -->